<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kilogram - Feed</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="icon" href="../static/burg.png">
</head>
<body style="overflow-y: hidden;">
    
    <nav class="nv">
        <div class="all">


            <div class="left">
            </div>


            <div class="center">
                <a href="#" class="anc feed">Feed</a>
                <a href="#" class="anc">Categories</a>
                <a href="#" class="anc">List</a>
            </div>


            <div class="right">
                <img src="../static/icon.png" class="profile">
            </div>


        </div>
    </nav>

    <div class="feedCon">
        <button class="new">Create Post</button>
        {% for user in users %}
            <a href="{{ url_for('profile', user_id=user.id)}}">
                test
            </a>
        {% endfor %}
    </div>

    <div class="createCon">
        <div class="createOverlay">
            <form class="create">
                <input type="text" name="postTitle" class="postTitle" placeholder="Title" maxlength="20">
                <textarea type="text" class="postDesc" placeholder="What's on your mind, {{ current_user.username }}?"></textarea>
            </form>
        </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <script>
        const n = document.querySelector('.new');
        const create = document.querySelector('.create');
        const createCon = document.querySelector('.createCon');
        const overlay = document.querySelector('.createOverlay');
        const title = document.querySelector('.postTitle');
        const desc = document.querySelector('.postDesc');
        const feedCon = document.querySelector('.feedCon');
        var on = false

        overlay.classList.remove('showOver');
        create.classList.remove('show');

        n.addEventListener('click', ()=> {
            if (on == false) {
                overlay.classList.add('showOver');
                create.classList.add('show');
                on = true;
            }
            
            else if (on == true){
                overlay.classList.remove('showOver');
                create.classList.remove('show');
                console.log('removed')
                on = false;
            };
        });

        document.addEventListener('click', (e)=> {
            if (create.classList.contains('show') && !n.contains(e.target) && !title.contains(e.target) && !desc.contains(e.target)) {
                overlay.classList.remove('showOver');
                create.classList.remove('show');
                on = false;
            }
        })

        create.addEventListener('click', (e)=> {
            e.stopPropagation();
        })

    </script>

    {% if current_user.is_authenticated %}

    <script>
        const profile2 = document.querySelector(".profile");

        profile2.addEventListener('click', ()=> {
            console.log("settings")
            window.location.href = "{{ url_for('profile', user_id=current_user.id) }}"
        })
    </script>
    
    {% else %}

    <script>
        const profile = document.querySelector(".profile");

        profile.addEventListener('click', ()=> {
            window.location.href = "{{ url_for('login') }}"
        })
    </script>

    {% endif %}
</body>
</html>